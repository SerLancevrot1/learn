### Docker

Все ниже - **слои**

* **FROM**... - образ операционной системы, на который будет установлен сервис с зависимостями
* **WORKDIR** - установка рабочей папки
* **RUN** - выполняет команду внутри контейнера
* **EXPOSE** - порт
* **CMD** - команды при запуске

Команды

* **docker build** - собрать образ. -t = задать имя и версию
* **docker images** - посмотреть все образы
* **docker run** - создает и запускает контейнер из образа. -р = пробросить порты
* **docker compose up** - создает и запускает несколько контейнеров. Нужен конфиг файл

### K8S

ПО для оркестрации контейнеризированных приложений

**Master-компоненты (управляющие):**

* **Control Plane** - ответственный за состояние кластера. Через REST принимает команды на менеджмент кластера. Единственный экземпляр
  * **Control Manager** - ответственный за поднятие/выключение подов
  * **Scheduler** - планировщик, ответственный за менеджмент ресурсов
  * **etcd** - хранение информации о кластере (ключ-значение)
  * **API server** - главный интерфейс между Control Plane и кластером

_Другие высокоуровневые службы, хранятся в **etcd**_

* **Deployment** - описывает, сколько копий подов нужно запустить и как их обновлять
* **Service** - обеспечивает доступ к подам через стабильный адрес (балансировщик нагрузки)
* **ConfigMap** и Secret - хранят чувствительные данные
* **Autoscaling** - автоматически добавляет или убирает поды в зависимости от нагрузки

**Node-компоненты (рабочие):**

* **WorkerNode** - контейнеризирует и запускает поды. Ниже - составляющие каждой ноды
    * **Pod** - минимальная единица в K8S, обертка контейнера
    * **kublet** - агент, запускающий контейнеры в нодах
    * **Container** Runtime запускает контейнеры в подах, менеджмент ресурсов в контейнере
    * **Kube-proxy** - отвечает за роутинг трафика к подам (балансировка)

**Дополнительные инструменты и службы**

* **Ingress-контроллер** - перенаправление HTTP-запросов к внутренним сервисам.
* **Network Policy Controller** - можно задать правило, согласно которому определённый набор pod’ов может общаться только с другими
  доверенными pod’ами, исключив нежелательные подключения.
* **Service Discovery** - обеспечивает автоматическое обнаружение сервисов и координацию их связи внутри кластера. 

**Объекты**

* **Namespace** - изолированная область в кластере
* **ServiceAccount** - техническая учетная запись
* **Pod** - минимальная величина в кубере, содержит один или несколько контейнеров
* **ReplicaSet** - следит за количеством под 
* **ConfigMap** - хранилище ключ-значение 
* **Secret** - хранилище ключ-значение, со скрытыми полями
* **Service** - позволяет по сети получить доступ к поду
* **Ingress** - трафик сети снаружи идет через Ingress
* **Job** - функция, которая выполняется один раз, порождает создание нового пода, под выполняет задачу и удалится
* **CronJob** - то же что и Job, только по расписанию
* **HorizontalPodAutoscaler** - регулирует кол-во под в зависимости от нагрузки
* **DaemonSet** - позволяет запустить поды на каждой ноде (логирование, журналирование)
* **StatefulSet** - позволяет деплоить поды с постоянным состоянием
* **LimitRange** - позволяет задавать дефолтные, минимальные и максимальные значения для параметров
* **ResourceQuota** - максимальные значения для неймспейса. Например, память, ядра ЦПУ
